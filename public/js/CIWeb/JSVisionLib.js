!function(a){if(!a.Morphology)throw new Error("Este objeto requiere la librería Morphology para continuar!");if(!a.Colors)throw new Error("Este objeto requiere la librería TurboColors para continuar!");a.JSVision={Feacture:{LBP:function(a,b){void 0!=b&&1!=isNaN(b)||(b=0);for(var c=new ImageData(a.width,a.height),d=new Int32Array(256),e=0,f=a.data.length;e<f;e+=4){for(var g=new Int16Array(8),h=0,i=Morphology.Position.set(e,a.width,4),j=new Int32Array([i.x-1>0?Morphology.Position.get(i.x-1,i.y,a.width,4):-1,i.x-1>0?Morphology.Position.get(i.x-1,i.y+1,a.width,4):-1,Morphology.Position.get(i.x,i.y+1,a.width,4),i.x+1<=a.width?Morphology.Position.get(i.x+1,i.y+1,a.width,4):-1,i.x+1<=a.width?Morphology.Position.get(i.x+1,i.y,a.width,4):-1,i.x+1<=a.width?Morphology.Position.get(i.x+1,i.y-1,a.width,4):-1,Morphology.Position.get(i.x,i.y-1,a.width,4),i.x-1>=0?Morphology.Position.get(i.x-1,i.y-1,a.width,4):-1]),k=0,l=j.length;k<l;k++)if(void 0!=a.data[j[k]]&&void 0!=a.data[j[k]+1]&&void 0!=a.data[j[k]+2]&&void 0!=a.data[e]&&void 0!=a.data[e+1]&&void 0!=a.data[e+2]){var m=Colors.RGB.Effects.Color.GrayScale(a.data[j[k]],a.data[j[k]+1],a.data[j[k]+2]),n=Colors.RGB.Effects.Color.GrayScale(a.data[e],a.data[e+1],a.data[e+2]);g[k]=m-n>=b?Math.pow(2,k):0,h+=g[k]}c.data[e]=h,c.data[e+1]=h,c.data[e+2]=h,c.data[e+3]=255,d[h]++}return[c,d]},LBPUniform:function(a,b){void 0!=b&&1!=isNaN(b)||(b=0);for(var c=new Uint8ClampedArray(a.length/4),d=new Int32Array(256),e=0,f=0,g=a.length;e<g;e+=4,f=e/4){for(var h=new Int16Array(8),i=0,j=0,k=Morphology.Position.set(e,W,4),l=new Int32Array([k.x-1>=0?Morphology.Position.get(k.x-1,k.y,W,4):-1,k.x-1>=0?Morphology.Position.get(k.x-1,k.y+1,W,4):-1,Morphology.Position.get(k.x,k.y+1,W,4),k.x+1<=W?Morphology.Position.get(k.x+1,k.y+1,W,4):-1,k.x+1<=W?Morphology.Position.get(k.x+1,k.y,W,4):-1,k.x+1<=W?Morphology.Position.get(k.x+1,k.y-1,W,4):-1,Morphology.Position.get(k.x,k.y-1,W,4),k.x-1>=0?Morphology.Position.get(k.x-1,k.y-1,W,4):-1]),m=0,n=l.length;m<n;m++)if(void 0!=a[l[m]]&&void 0!=a[l[m]+1]&&void 0!=a[l[m]+2]&&void 0!=a[e]&&void 0!=a[e+1]&&void 0!=a[e+2]){var o=Colors.RGB.Effects.Color.GrayScale(a[l[m]],a[l[m]+1],a[l[m]+2]),p=Colors.RGB.Effects.Color.GrayScale(a[e],a[e+1],a[e+2]);h[m]=o-p>=b?Math.pow(2,m):0,i+=h[m]}for(var m=0,n=h.length-1;m<=n;m++)m<n?(0!=h[m]&&0==h[m+1]||0==h[m]&&0!=h[m+1])&&j++:(0!=h[m]&&0==h[0]||0==h[m]&&0!=h[0])&&j++;2!=j&&0!=j&&(i=0),c[f]=i,d[i]++}return[c,d]},HaarLike:function(a){console.log("HAAR LIKE isn't completed...")},TemplateMatching:function(a,b){var c=new Int32Array(a.data.length),d={x:Math.floor((a.width-1)/2),y:Math.floor((a.height-1)/2),index:0};d.index=Math.floor(d.x+d.y*a.width);for(var e=0,f=a.data.length;e<f;e++){var g={y:Math.floor(e/W),x:0},h=0;g.x=Math.floor(e-g.y*W);for(var i=0;i<a.height;i++)for(var j=0;j<a.width;j++){var k=j-d.x,l=i-d.y,m=g.x-k,n=g.y-l,o=j+i*a.width,p=m+n*W;a.data[p]&&(h+=Math.pow(b[o]-a.data[p],2))}c[e]=Math.round(h)}return c}},window:{foreach:function(a,b,c,d,e){for(var f=0,g=d-1;f+g<a.height;f+=b)for(var h=0,i=c-1;h+i<a.width;h+=b){var j=a.cloneImage(h,f,c,d);e(j,{x:h,y:f,width:c,height:d})}},filter:function(b,c,d,e,f){var g=[];return a.JSVision.window.foreach(b,c,Wm,Hm,function(a){var b=f(a)||!1;1==b&&g.push(a)}),g},Pyramid:{foreach:function(a,b,c,d,e){for(var f=0,g=a.width,h=a.height;g>=c&&h>=d;f++,g=Math.round(a.width/Math.pow(b,f)),h=Math.round(a.height/Math.pow(b,f))){var i=a.scale(g,h);e(i)}},filter:function(b,c,d,e,f){var g=[];return a.JSVision.window.Pyramid.foreach(b,c,d,e,function(a){var b=f(a)||!1;1==b&&g.push(a)}),g},map:function(b,c,d,e,f){var g=[];return a.JSVision.window.Pyramid.foreach(b,c,d,e,function(a){g.push(f(a))}),g}}},step:{filter:function(a){for(var b=[],c=0,d=a.sort(function(a,b){return b.h-a.h});d[c];){for(var e=!1,f=0;b[f];){var g=Geometry.Polygons.Rectangule.Overlap(d[c].x,d[c].y,d[c].width,d[c].height,b[f].x,b[f].y,b[f].width,b[f].height);if(g>.5){e=!0;break}f++}0==e&&(b[b.length]=d[c]),d.splice(c,1)}return b}}}}(this);